#!/usr/bin/env ruby
require 'pathname'
require 'optparse'

base_path = Pathname(__FILE__).dirname.parent.expand_path
$LOAD_PATH.unshift("#{base_path}/lib")

require 'roma/tools/roma-adm'

# opt parse
opts = OptionParser.new
opts.banner="usage:#{File.basename($0)} [command] [port No.]"
opts.on("-h", "--help", "Show this message") {
  puts opts; exit
}
opts.parse!(ARGV)

# argument check
if ARGV.size != 2
  puts "Argument Error: roma-adm [adm-command] [port No.]"
  exit
elsif ARGV[1] !~ /^\d+$/
  puts "Argument Error: roma-adm [adm-command] [port No.]"
  puts "[port No.] should be Interger"
  exit
end

begin
  adm = Roma::Adm.new(ARGV[0], ARGV[1])
  adm.check_type
  res = adm.send_command
  puts "\r\n#{res}"
rescue => e
  puts e.message
end
